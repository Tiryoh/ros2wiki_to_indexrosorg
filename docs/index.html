<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.5/jquery.csv.min.js"></script>
    <script type = "text/javascript">
        function readCsv(data) {
            var target = '#csv-body';
            var csv = $.csv.toArrays(data);
            var insert = '';
            $(csv).each(function() {
                if (this[0][0] == 'h') {
                insert += '<tr><td>' + this[0] + '</td><td><a href="' + this[1] + '">' + this[1] + '</a></td></tr>';
                }
            });
            $(target).append(insert);
        }
        var csvfile = 'https://raw.githubusercontent.com/Tiryoh/ros2wiki_to_indexrosorg/master/url.csv';
        $(function () {
            searchWord = function(){
                var searchResult,
                    searchText = $(this).val(), // 検索ボックスに入力された値
                    targetText,
                    hitNum;

                // 検索結果を格納するための配列を用意
                searchResult = [];

                // 検索結果エリアの表示を空にする
                $('#search-result__list').empty();
                $('.search-result__hit-num').empty();

                // 検索ボックスに値が入ってる場合
                if (searchText != '') {
                $('.target-area tr').each(function() {
                    targetText = $(this).text();

                    // 検索対象となるリストに入力された文字列が存在するかどうかを判断
                    if (targetText.indexOf(searchText) != -1) {
                    // 存在する場合はそのリストのテキストを用意した配列に格納
                        // searchResult.push(this);
                        searchResult.push('<tr><td>' + this.cells[0].innerHTML + '</td><td>' + this.cells[1].innerHTML + '</td><tr>');
                    }
                });

                // 検索結果をページに出力
                for (var i = 0; i < searchResult.length; i ++) {
                    $('#search-result__list').append(searchResult[i]);
                }

                // ヒットの件数をページに出力
                hitNum = '<span>Search Result</span>： Found ' + searchResult.length + ' items in list';
                    $('.search-result__hit-num').append(hitNum);
                }
            };

            // searchWordの実行
            $('#search-text').on('input', searchWord);
            $.get(csvfile, readCsv, 'text');
        });

    </script>
    
</head>
<body>
    <p>The URL list is published and maintained on <a href="https://github.com/Tiryoh/ros2wiki_to_indexrosorg">GitHub</a>.</p>

    <div class="search-area">
        Search:
        <form>
            <input type="text" id="search-text" placeholder="input keyword">
        </form>
        <div class="search-result">
            <div class="search-result__hit-num"></div>
            <table>
                <tbody id="search-result__list">
            </table>
        </div>
    </div>

    <div class="url-list">
        <table>
        <caption>ROS2 document list</caption>
        <thead>
            <tr><th>old_url</th><th>new_url</th></tr>
        </thead>
        <tbody id="csv-body" class="target-area">
        </table>
    </div>
    
    <style type="text/css">
    <!-- 
        .search-area input[type="text"] {
            padding: 5px 5px 3px;
            font-size: 16px;
            border: 1px solid #D6D6D6;
        }

        .search-area input[type="text"]:focus {
            background: #F9F9F9;
        }

        .search-result {
            margin-top: 20px;
        }
        .search-result__hit-num span {
            font-weight: bold;
        }
        #search-result__list {
            margin-top: 15px;
        }
        #search-result__list span {
            display: inline-block;
            margin-right: 15px;
            padding: 5px;
            background: #F2F2F2;
        }
        .target-area {
            margin-top: 50px;
        }
        -->
    </style>
</body>
</html>